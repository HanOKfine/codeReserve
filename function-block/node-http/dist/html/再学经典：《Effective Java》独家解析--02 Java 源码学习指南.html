<!doctype html>
<html lang="zh_CN">

    

    

    
    
    
    <head>
        
        <title>02 Java 源码学习指南</title>
        
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="学习Java很重要，学会怎么学习Java更重要">
        <meta name="keywords" content="慕课网">
        <meta name="author" content="">
        <meta name = "format-detection" content="telephone=no">
        <meta http-equiv="Cache-Control" content="no-transform " />
        <meta http-equiv="Cache-Control" content="no-siteapp" />
        <link rel="shortcut icon" href="https://m.imooc.com/static/wap/static/favicon.ico" />
        
        
        
        <script type="text/javascript" src="https://m.imooc.com/static/wap/static/common/js/flexible.js"></script>
        
        <script type="text/javascript">
            var userInfo = "";
            
                var isApp = 0;
            
        </script>
         
<!-- 专栏首页列表模板 -->
<script type="text/template" id="index-list-tpl">
<ul class="list-con">
    {@each data.data as item}
        <li>
            <a href="/read/${item.id}" class="item clearfix">
                <div class="img l" style="background-image: url(${item.app_pic1})">
                    {@if item.is_new }
                        <div class="icon new">
                            上新
                        </div>
                    {@else if item.is_marking} 
                        <div class="icon">
                            经典
                        </div>
                    {@/if} 
                </div>
                <div class="text-con l">
                    <div class="title">
                        ${item.title}
                    </div>
                    <div class="desc">
                        ${item.chapter_num}节 · ${item.description}
                    </div>
                     <div class="user-info">
                        ${item.nickname}
                        {@if item.author_title }
                        <span class="dot">
                            ·
                        </span>
                        ${item.author_title}
                        {@/if}
                    </div>
                    <div class="info clearfix">
                    {@if !item.isBuy } 
                        <!-- 未购买才显示 -->
                        <div class="price-con l">
                        {@if item.open_discount == "1" }
                            <span class="now">￥${item.pay_price}</span>
                            <span class="ori">￥${item.price}</span>
                            <p class="sale">${item.discount_name}</p>
                        {@else}
                            <span class="now">￥${item.price}</span>
                        {@/if}
                        </div>
                    {@/if}
                        <div class="taste-con r">
                            <span>${item.numbers}人订阅</span>
                            {@if !item.isBuy }
                                <span class="gotaste">试读</span>
                            {@else}
                                <span class="gotaste">学习</span>
                            {@/if}
                        </div>
                    </div>
                </div>
            </a>
        </li>
    {@/each}
</ul>
</script>



<!-- 专栏目录 买后目录页、 -->
<script type="text/template" id="detail-catalog-tpl">
<ul class="catalog-list">
{@each data.list as item}
    <li class="zhang">
        {@if data.structure_mode == "1" }
            <!--章节模式-->
            <div class="zhang-title">
                ${item.title}（${item.count}节）
            </div>
            <div class="zhang-sub-title">
                ${item.short_introduce}
            </div>
        {@/if}  
        <ul class="zhang-detail">
            {@each item.list as it,i}
                <li class="jie">
                    {@if data.isLogin }
                        <!-- 购买了  -->
                        {@if data.isBuy }
                        <a href="javascript:;" data-link="/read/${data.column_id}/article/${it.id}" class="js-go-read">
                        {@else}
                        <a href="javascript:;" data-link="/read/${data.column_id}/article/${it.id}" class="js-go-read" >
                        {@/if}
                    {@else}
                        <!-- 未登录  -->
                        {@if data.isApp }
                            <a href="javascript:;" onclick="window.nativeSupport.login();">
                        {@else}
                            <a href="//m.imooc.com/account/login?backurl=/read/${data.column_id}">
                        {@/if}
                    {@/if}
                        <div class="jie-con {@if data.last_chapter == it.id }recent{@/if}">
                            
                            <div class="text-con">
                                <div class="jie-title">
                                    ${it.title}
                                </div>
                                <div class="jie-status">
                                    {@if it.is_open == "0" }
                                        <span class="update-time" >${it.open_time_fmt}</span>
                                    {@/if}
                                    {@if it.view_num > 100 }
                                    <div class="learn-num">
                                        <i class="imwap-set-sns"></i>
                                        <span>${it.view_num}</span>
                                    </div>
                                    {@/if}
                                    {@if it.in_24hours == "1" }
                                        <span class="update-recent">最近更新</span>
                                    {@/if}
                                </div>
                            </div>
                        </div>
                        {@if it.is_learned }
                            <div class="jie-right haslearn is_learned js-learn" data-type="1">
                                已学
                            </div>
                        {@else}
                            <!-- 购买了  -->
                            {@if data.isBuy }
                                <div class="jie-right learn js-learn" data-type="1">
                                    学习
                                </div>
                            {@else}
                                {@if it.is_pay == "0" }
                                <!--免费小节 不占用试读次数  -->
                                    <div class="jie-right learn js-learn" data-type="1">
                                        免费
                                    </div>
                                {@else}
                                    <div class="jie-right learn js-learn" data-type="0">
                                        学习
                                    </div>
                                {@/if}
                            {@/if}
                            
                            
                        {@/if}
                    </a>
                </li>
            {@/each}
        </ul>
    </li>
{@/each}
</ul>
</script> 

<!-- 阅读页 阅读页   专栏目录  -->
<script type="text/template" id="catalog-tpl">
<div>
    <h2 class="article-title">${data.a_name}</h2>
    <ul class="catalog">
    {@each data.list as item}
        <li class="zhang">
            {@if data.structure_mode == "1" }
                <!--章节模式-->
                <div class="zhang-title">
                    ${item.title}
                    <!-- <div class="num">共${item.count}节</div> -->
                </div>
            {@/if}  
            <ul class="zhang-detail">
                {@each item.list as it,i}
                    <li class="jie">
                        <!--买了且开放的-->
                        <a href="/read/${data.column_id}/article/${it.id}">
                            <div class="jie-title clearfix full">
                                <p>
                                    {@if data.last_chapter == it.id }
                                        <span class="recent">最近阅读</span>
                                    {@/if}
                                    ${it.title}
                                </p>
                            </div>
                        </a>
                    </li>
                {@/each}
            </ul>
        </li>
    {@/each}
    </ul>
</div>
</script>





<script type="text/javascript">
	var isApp = "";
	var clientVersion = "0";
	var count_num = "5";
	var chapter_id = "1976";
	var chapter_title = "02 Java 源码学习指南";
	var aid = "78";
	var a_name = "再学经典：《Effective Java》独家解析";
	var a_price = "68.00";
	var a_pic = "https://img2.mukewang.com/5ecf522a00013a1d05400720.jpg";
	var userId = 0;

	var column_id = '78';
	var isLogin = 0;
	

</script>
<!-- 引入字体 -->
<script type="text/javascript" src="//cdn.webfont.youziku.com/wwwroot/js/wf/youziku.api.min.js"></script>
<script type="text/javascript">
$youziku.load(".top-con .title, .cl-preview-section h1,.cl-preview-section h2,.cl-preview-section h3,.cl-preview-section h4,.cl-preview-section h5,.cl-preview-section h6", "37af461390fa4d138f5c3d277f7286dc", "SourceHanSerifSC-Heavy"); // 思源宋体heavy
$youziku.load(".lead-motto, .cl-preview-section blockquote", "d9a0d855583142c3b2cc3bf1646a8473", "SourceHanSerifSC-Regular"); // 思源宋体regular
$youziku.load("#article_content, .cl-preview-section pre, .cl-preview-section code, #code-copy", "3d84aabcf9e44b6f8c6fa91c61fa926e", "HYQiHei-55S"); // 汉仪旗黑55s
$youziku.load(".cl-preview-section strong", "fd94fff3a17546a28913a79613bddcec", "HYQiHei-77S"); // 汉仪旗黑70s

$youziku.draw();
</script>

<style type="text/css">
  header{
    display: none!important;
  }
  
  #wrapper{
  	padding-top:0px !important;
  }
  
</style>



    <link rel="stylesheet" href="https://m.imooc.com/static/wap/static/common/css/common_d42b1ef.css" /><link rel="stylesheet" href="https://m.imooc.com/static/wap/static/css/read/7.2.8/article_2d28313.css" /></head>
    <body >
        
          
        

        
          
        

        
          







<header class="directory2">
	<div class="header clearfix">
		
			
				<div class="page-title clearfix">
					<a href="//m.imooc.com" class="imwap-icon-imooc"></a>
					<div class="page-title-name js-page-name">
						<span>专栏</span>
						<i class="imwap-arrow_d"></i>
					</div>
				</div>
			

			
			<div class="drawer-box js-drawer-more">
				<i class="imwap-more_vert"></i>
				<div class="drawer-content js-drawer-content">
					<p class="line-row"></p>
					<a class="drawer-item" href="//m.imooc.com"><i class="imwap-center"></i>回到首页</a>
					<a class="drawer-item" href="//www.imooc.com/m/web/user/usercenter.html"><i class="imwap-peaple"></i>个人中心</a>
					<a class="drawer-item" href="//m.imooc.com/feedback"><i class="imwap-comment"></i>反馈问题</a>
					
					<a class="drawer-item" href="//m.imooc.com/account/login"><i class="imwap-out"></i>注册登录</a>
					
				</div>
			</div>
			

			
				<a id="js-appload" href="Javascript:;" class="app-load"><span>下载APP</span></a>
			

		
	</div>
	
	<div class="page-tab-wrap">
		<div class="page-tab-list">
			<a href="//m.imooc.com" class="page-tab-item">首页</a>
			<a href="//m.imooc.com/course/list" class="page-tab-item">课程</a>
			<a href="//coding.m.imooc.com" class="page-tab-item">实战</a>
			<a href="//class.m.imooc.com" class="page-tab-item">金职位</a>
			<a href="//m.imooc.com/article" class="page-tab-item">手记</a>
			<a href="//m.imooc.com/read" class="page-tab-item active">专栏</a>
			<a href="//m.imooc.com/wenda" class="page-tab-item">猿问</a>
			<a href="//m.imooc.com/wiki" class="page-tab-item">慕课教程</a>
			
		</div>
	</div>
	
</header>


        

        <div id="wrapper">
            <div id="middle" class="container ">

                

                
	
		
	
	<div class="top-con">
		<p class="update-time"><span>2020-05-27&nbsp;&nbsp;&nbsp;更新</span></p>
		<div class="title">
			02 Java 源码学习指南
		</div>
	</div>
	
		<div class="article-img" style="background-image: url('https://img4.mukewang.com/5ece268a0001f21706400359.jpg')"></div>
	
	
		<a href="/read/78">
			<div class="course-entry">
				<img src="https://img.mukewang.com/54dc328d0001b75e04630463-40-40.jpg" alt="明明如月">
				<h3>再学经典：《Effective Java》独家解析</h3>
				<p>明明如月 · 高级JAVA开发工程师 </p>
				<i class="imwap-arrow_r"></i>
			</div>
		</a>
	
	
		<div class="lead-motto">
			<div class="content">构成我们学习最大障碍的是已知的东西，而不是未知的东西。 <p class="author">—— 贝尔纳</p></div>
		</div>
	
	
		<div class="content" id="article_content">
			
			<div class="cl-preview-section"><h1 id="前言">1. 前言</h1>
</div><div class="cl-preview-section"><p>在正式解读《Effective Java》之前，我们需要先了解读源码究竟要读什么，了解怎么读源码更有效。</p>
</div><div class="cl-preview-section"><p>结合源码才能更好地理解《Effective Java》一书中一些建议的原因，更清楚地了解规则如何落地。</p>
</div><div class="cl-preview-section"><p>另外，贯穿整个专栏的大多数章节会涉及到 Java 源码，因此能够快速读懂源码对我们专栏后续的学习有极大的帮助。</p>
</div><div class="cl-preview-section"><p>读源码也是我们学习进阶的必经之路。读源码可以了解设计模式的场景，可以了解并熟悉框架的底层实现，可以学习某个不熟悉类的用法，可以学习优秀的编程技巧等，这些对我们编程能力的提高也有极大的帮助。</p>
</div><div class="cl-preview-section"><p>然而很多人读源码会感到无从下手；读源码很容易遗忘；读源码不知有何用；读源码花费时间很多但是效果不佳，很难坚持下去。</p>
</div><div class="cl-preview-section"><p>本节将为大家讲解 Java 源码学习的一些经验。<br>
<img src="https://img.mukewang.com/5ece411a0001c60c18181166.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><h1 id="读源码究竟读什么">2. 读源码究竟读什么</h1>
</div><div class="cl-preview-section"><p>我们做事情要遵循 “以终为始” 的思想，即需要明确我们的目标，这样才能避免跑偏，才能避免走弯路。</p>
</div><div class="cl-preview-section"><p>如果读源码毫无目标，毫无重点，“走马观花” 最终将收获无多。</p>
</div><div class="cl-preview-section"><p><strong>那么读源码读的是什么？我们要关注哪些方面呢？</strong></p>
</div><div class="cl-preview-section"><p><strong>读目的</strong>： 该框架是为了解决什么问题？比同类框架相比的优劣是什么？这对理解框架非常重要。</p>
</div><div class="cl-preview-section"><p><strong>注释：</strong> 很多人可能会奇怪，读源码怎么还需要关注注释呢？其实这正是我要特别强调的地方，很多人读源码会忽略注释。这里建议大家读源码时一定要重视注释。因为某个类、某个函数的目的、核心逻辑、核心参数的解释，异常的发生场景等都会写到注释中，这对我们学习源码，分析问题有极大的帮助。因此建议大家一定要重视源码注释。</p>
</div><div class="cl-preview-section"><p><strong>逻辑：</strong> 这里所谓的逻辑是指语句或者子函数的顺序问题。我们要重视作者编码的顺序，了解为什么先写 A 再写 B，背后的原因是什么。</p>
</div><div class="cl-preview-section"><p><strong>思想：</strong> 所谓思想是指源��背后体现出了哪些设计原则，比如是不是和设计模式的六大原则相符？是不是符合高内聚低耦合？是不是体现某种优化思想？</p>
</div><div class="cl-preview-section"><p><strong>读原理</strong>：读核心实现步骤，而不是记忆每行代码。核心原理和步骤最重要。</p>
</div><div class="cl-preview-section"><p><strong>风格:</strong> 一般来说优秀的源码的代码风格都比较优雅。我们可以通过源码来学习编码规范。比如类、函数、变量命名，注释的规范等。</p>
</div><div class="cl-preview-section"><p><strong>技巧:</strong>  作者是否采用了某种设计模式，某种编程技巧实现了意料之外的效果。</p>
</div><div class="cl-preview-section"><p><strong>方案:</strong> 读源码不仅包含具体的代码，更重要的是设计方案。比如我们下载一个秒杀系统 / 商城系统的代码，我们可以学习密码加密的方案，学习分布式事务处理的方案，学习幂等的设计方案，超卖问题的解决方案等。因为掌握这些方案之后对提升我们自己的工作经验非常有帮助，我们工作中做技术方案时可以参考这些优秀项目的方案。</p>
</div><div class="cl-preview-section"><h1 id="读源码的误区">3. 读源码的误区</h1>
</div><div class="cl-preview-section"><p>很多人读源码不顺利，效果不好，通常都会有些共性。</p>
</div><div class="cl-preview-section"><p><strong>那么读源码通常会有哪些误区呢？</strong></p>
</div><div class="cl-preview-section"><h2 id="开局打-boss">3.1 开局打 boss</h2>
</div><div class="cl-preview-section"><p>经常打游戏的朋友都知道，开局直接打 boss 无异于送人头。</p>
</div><div class="cl-preview-section"><p>一般开局先打野，练就了经验再去挑战 boss。</p>
</div><div class="cl-preview-section"><p>开始尝试学习源码就直接拿大型开源框架入手容易自信心受挫，导致放弃。</p>
</div><div class="cl-preview-section"><h2 id="佛系青年">3.2 佛系青年</h2>
</div><div class="cl-preview-section"><p>经常打游戏的朋友也都知道，打游戏要讲究策略，随便瞎打很容易失败。</p>
</div><div class="cl-preview-section"><p>同样地，有些朋友决定读源码，但是没有规划，看到哪是哪，随心所欲，往往效果不太好。</p>
</div><div class="cl-preview-section"><h2 id="“对着答案做题”">3.3 “对着答案做题”</h2>
</div><div class="cl-preview-section"><p>“对着答案做题” 和读源码误区有啥关系呢？</p>
</div><div class="cl-preview-section"><p>莫急，且听我慢慢分解。</p>
</div><div class="cl-preview-section"><p>我们知道很多小学生、初高中生，甚至很多大学生学习会出现眼高手低的情况。</p>
</div><div class="cl-preview-section"><p>有些人做题时并不是先思考，而是先看答案，然后对着答案的思路来理解题目。在这种模式下，大多数题目都理所当然地这么做，会误认为自己真正懂了。但是即使是原题，也会做错，想不出思路。</p>
</div><div class="cl-preview-section"><p>同样地，很多人读源码也会走到这个误区中。直接看源码的解析，直接看源码的写法，缺乏了关键的前置步骤，即先自己思考再对照源码。</p>
</div><div class="cl-preview-section"><h1 id="读源码的思想">4. 读源码的思想</h1>
</div><div class="cl-preview-section"><h2 id="先会用再读源码">4.1 先会用再读源码</h2>
</div><div class="cl-preview-section"><p>所谓 “心急吃不到热豆腐”。</p>
</div><div class="cl-preview-section"><p>学习某个源码之前一定要对源码的基本用法有一个初步了解。</p>
</div><div class="cl-preview-section"><p>如果对框架没有基本的了解就直接读源码，效果一般不会太好。</p>
</div><div class="cl-preview-section"><p>一般优秀的开源项目，都会给出一些简单的官方示例代码，大家可以将官方示例代码跑起来，了解基本用法。</p>
</div><div class="cl-preview-section"><p>大家也可以去 github 上搜索并拉取某个技术的 demo ，某个技术的 hello world 项目，快速用起来。</p>
</div><div class="cl-preview-section"><p>如 dubbo 官方文档就给出了<a href="https://dubbo.apache.org/zh-cn/docs/user/quick-start.html">快速上手示例代码</a> ；轻量级的分布式服务框架 <a href="https://github.com/fengjiachun/Jupiter">jupiter README.md</a>   就给出了简单的调用示例。一些开源项目给出了多个框架的示例代码，如 <a href="https://github.com/eugenp/tutorials">tutorials</a>。</p>
</div><div class="cl-preview-section"><h2 id="先易后难">4.2 先易后难</h2>
</div><div class="cl-preview-section"><p>循序渐进是学习的一大规律。</p>
</div><div class="cl-preview-section"><p>一方面，可以先尝试阅读较为简单的开源项目源码，比如 <a href="https://github.com/apache/commons-lang">commons-lang</a>、<a href="https://github.com/apache/commons-collections">commons-collection</a>、<a href="https://github.com/google/guava">guava</a>、<a href="https://github.com/mapstruct/mapstruct">mapstruct </a>等工具性质的源码。</p>
</div><div class="cl-preview-section"><p>另外还可以尝试寻找某个框架的简单版，先从简单版学起，看透了再学大型的开源项目就容易很多。</p>
</div><div class="cl-preview-section"><p>可能很多人会说不好找，其实大多数知名开源的项目都会有简单版，用心找大多数都可以找到，比如 <a href="https://github.com/pjc516113732/gupaoedu-vip-spring-1.0">spring 的简易版</a>、<pangu> </pangu><a href="https://github.com/fengjiachun/Jupiter">dubbo 简易版</a>。</p>
</div><div class="cl-preview-section"><h2 id="先整体后局部">4.3 先整体后局部</h2>
</div><div class="cl-preview-section"><p>先整体后局部是非常重要的一个认知规则，体现了 “整体思维”。</p>
</div><div class="cl-preview-section"><p>如果对框架缺乏整体认识，很容易陷入局部细节之中。</p>
</div><div class="cl-preview-section"><p>先整体后局部包括多种含义，下面会介绍几种核心的含义。</p>
</div><div class="cl-preview-section"><h3 id="先看架构再读源码">4.3.1 先看架构再读源码</h3>
</div><div class="cl-preview-section"><p><strong>大家可以通过框架的官方文档了解其整体架构，了解其核心原理，然后再去看具体的源代码。</strong></p>
</div><div class="cl-preview-section"><p>但是很多人总会忽视这个步骤。</p>
</div><div class="cl-preview-section"><p>如轻量级分布式服务框架 <a href="https://github.com/fengjiachun/Jupiter">jupiter 框架</a> 的 <a href="http://README.md">README.md</a> 给出了框架的整体架构：<br>
<img src="https://img.mukewang.com/5ece413e00012c1d14960846.png" alt="图片描述">（图片来自： jupiter 项目 <a href="http://README.md">README.md</a> 文档）</p>
</div><div class="cl-preview-section"><p>对框架有了一个整体了解之后，再去看具体的实现就会容易很多。</p>
</div><div class="cl-preview-section"><h4 id="先看项目结构再读源码">4.3.2 先看项目结构再读源码</h4>
</div><div class="cl-preview-section"><p>先整体后局部，还包括<strong>先看项目的分包，再具体看源码</strong>。<br>
<img src="https://img.mukewang.com/5ece416e0001faab13680954.png" alt="图片描述">（图片来自： jupiter 项目结构）</p>
</div><div class="cl-preview-section"><p>通过项目的包名，如 monitor 、 registry、serialization、example、common 等就可以明白该包下的代码意图。</p>
</div><div class="cl-preview-section"><h3 id="先看类的函数列表再读源码">4.3.3 先看类的函数列表再读源码</h3>
</div><div class="cl-preview-section"><p>通过 IDEA 的函数列表功能，可以快速了解某个类包含的函数，可以对这个类的核心功能有一个初步的认识。</p>
</div><div class="cl-preview-section"><p>这种方式在读某些源码时效果非常棒。</p>
</div><div class="cl-preview-section"><p>更重要的是，如果能够养成查看函数列表的习惯，可以发现很多重要但是被忽略的函数，在未来的项目开发中很可能会用到。</p>
</div><div class="cl-preview-section"><p>下图为 commons-lang3 的 3.9 版本中 StringUtils 类的函数列表示意图：<br>
<img src="https://img.mukewang.com/5ece4189000114f411500701.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><h3 id="先看整体逻辑再看某个步骤">4.3.4 先看整体逻辑再看某个步骤</h3>
</div><div class="cl-preview-section"><p>比如一个大函数可能分为多个步骤，我们先要理解某个步骤的意图，了解为什么先执行子函数 1, 再执行子函数 2 等。</p>
</div><div class="cl-preview-section"><p>然后再去观察某个子函数的细节。</p>
</div><div class="cl-preview-section"><p>以 spring-context 的 5.1.0.RELEASE 版本的 IOC 容器的核心类 <code>org.springframework.context.support.AbstractApplicationContext</code> 的核心函数 <code>refresh</code> 为例：</p>
</div><div class="cl-preview-section"><pre class=" language-java"><code class="prism  language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> BeansException<span class="token punctuation">,</span> IllegalStateException <span class="token punctuation">{</span>
   <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>startupShutdownMonitor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Prepare this context for refreshing.</span>
      <span class="token comment">// 1 初始化前的预处理</span>
      <span class="token function">prepareRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// Tell the subclass to refresh the internal bean factory.</span>
      <span class="token comment">// 2 告诉子类去 refresh 内部的 bean Factory </span>
      ConfigurableListableBeanFactory beanFactory <span class="token operator">=</span> <span class="token function">obtainFreshBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// Prepare the bean factory for use in this context.</span>
      <span class="token comment">// 3 BeanFactory 的预处理配置</span>
      <span class="token function">prepareBeanFactory</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">try</span> <span class="token punctuation">{</span>
         <span class="token comment">// Allows post-processing of the bean factory in context subclasses.</span>
        <span class="token comment">// 4 准备 BeanFactory 完成后进行后置处理</span>
         <span class="token function">postProcessBeanFactory</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Invoke factory processors registered as beans in the context.</span>
         <span class="token comment">// 5 执行BeanFactory创建后的后置处理器</span>
         <span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Register bean processors that intercept bean creation.</span>
         <span class="token comment">// 6 注册Bean的后置处理器</span>
         <span class="token function">registerBeanPostProcessors</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Initialize message source for this context.</span>
         <span class="token comment">// 7 初始化MessageSource</span>
         <span class="token function">initMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Initialize event multicaster for this context.</span>
         <span class="token comment">// 8 初始化事件派发器</span>
         <span class="token function">initApplicationEventMulticaster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Initialize other special beans in specific context subclasses.</span>
         <span class="token comment">// 9 子类的多态onRefresh</span>
         <span class="token function">onRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Check for listener beans and register them.</span>
         <span class="token comment">// 10 检查监听器并注册</span>
         <span class="token function">registerListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Instantiate all remaining (non-lazy-init) singletons.</span>
         <span class="token comment">// 11 实例化所有剩下的单例 Bean (非懒初始化)</span>
         <span class="token function">finishBeanFactoryInitialization</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Last step: publish corresponding event.</span>
         <span class="token comment">// 12 最后一步，完成容器的创建</span>
         <span class="token function">finishRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BeansException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isWarnEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Exception encountered during context initialization - "</span> <span class="token operator">+</span>
                  <span class="token string">"cancelling refresh attempt: "</span> <span class="token operator">+</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>

         <span class="token comment">// Destroy already created singletons to avoid dangling resources.</span>
        <span class="token comment">// 销毁已经常见的单例 bean </span>
         <span class="token function">destroyBeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Reset 'active' flag.</span>
         <span class="token comment">// 重置  active 标志</span>
         <span class="token function">cancelRefresh</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token comment">// Propagate exception to caller.</span>
         <span class="token comment">// 将异常丢给调用者</span>
         <span class="token keyword">throw</span> ex<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">finally</span> <span class="token punctuation">{</span>
         <span class="token comment">// Reset common introspection caches in Spring's core, since we</span>
         <span class="token comment">// might not ever need metadata for singleton beans anymore...</span>
        <span class="token comment">// 重置缓存</span>
         <span class="token function">resetCommonCaches</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><p>我们要特别重视每个步骤的含义，思考为什么这些要这么设计，然后再进入某个子函数中去了解具体的实现。</p>
</div><div class="cl-preview-section"><p>比如再去了解 第 7 步的具体编码实现。</p>
</div><div class="cl-preview-section"><pre class=" language-java"><code class="prism  language-java"><span class="token comment">/**
 * Initialize the MessageSource.
 * Use parent's if none defined in this context.
 */</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">initMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   ConfigurableListableBeanFactory beanFactory <span class="token operator">=</span> <span class="token function">getBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>beanFactory<span class="token punctuation">.</span><span class="token function">containsLocalBean</span><span class="token punctuation">(</span>MESSAGE_SOURCE_BEAN_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>messageSource <span class="token operator">=</span> beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>MESSAGE_SOURCE_BEAN_NAME<span class="token punctuation">,</span> MessageSource<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// Make MessageSource aware of parent MessageSource.</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>parent <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messageSource <span class="token keyword">instanceof</span> <span class="token class-name">HierarchicalMessageSource</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         HierarchicalMessageSource hms <span class="token operator">=</span> <span class="token punctuation">(</span>HierarchicalMessageSource<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messageSource<span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>hms<span class="token punctuation">.</span><span class="token function">getParentMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Only set parent context as parent MessageSource if no parent MessageSource</span>
            <span class="token comment">// registered already.</span>
            hms<span class="token punctuation">.</span><span class="token function">setParentMessageSource</span><span class="token punctuation">(</span><span class="token function">getInternalParentMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">"Using MessageSource ["</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messageSource <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// Use empty MessageSource to be able to accept getMessage calls.</span>
      DelegatingMessageSource dms <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DelegatingMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      dms<span class="token punctuation">.</span><span class="token function">setParentMessageSource</span><span class="token punctuation">(</span><span class="token function">getInternalParentMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>messageSource <span class="token operator">=</span> dms<span class="token punctuation">;</span>
      beanFactory<span class="token punctuation">.</span><span class="token function">registerSingleton</span><span class="token punctuation">(</span>MESSAGE_SOURCE_BEAN_NAME<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messageSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">"No '"</span> <span class="token operator">+</span> MESSAGE_SOURCE_BEAN_NAME <span class="token operator">+</span> <span class="token string">"' bean, using ["</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messageSource <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><p>从该子函数的角度，“整体” 为 if  和 else 两个代码块，“部分” 为 if 和 else 的代码块的具体步骤。</p>
</div><div class="cl-preview-section"><h2 id="从设计者的角度学源码">4.4 从设计者的角度学源码</h2>
</div><div class="cl-preview-section"><p>从设计者的角度读源码是一条极其重要的思想。体现了 **“先猜想后验证”** 的思想。</p>
</div><div class="cl-preview-section"><p>这样就可以走出 “对着答案做题” 的误区。</p>
</div><div class="cl-preview-section"><p>学习源码时不管是框架的整体架构、某个具体的类还是某个函数都要设想如果自己是作者，该怎么设计框架、如何编写某个类、某个函数的代码。</p>
</div><div class="cl-preview-section"><p>然后再和最终的源码进行对比，发现自己的设想和对方的差异，这样对源码的印象更加深刻，对作者的意图领会的会更加到位。</p>
</div><div class="cl-preview-section"><p>比如我们封装 HTTP 请求工具，获取响应后根据响应码判断是否成功，我们可能会这么写：</p>
</div><div class="cl-preview-section"><pre class=" language-java"><code class="prism  language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isSuccessful</span><span class="token punctuation">(</span>Integer code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">200</span> <span class="token operator">==</span> code<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><p>我们查看 okhttp 4.3.0 版本的源码，依赖：</p>
</div><div class="cl-preview-section"><pre class=" language-xml"><code class="prism  language-xml"><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/com.squareup.okhttp3/okhttp --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.squareup.okhttp3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>okhttp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
</div><div class="cl-preview-section"><p><code>okhttp3.Response</code> 类的 <code>isSuccessful</code> 函数源码注释和代码 (kotlin)：</p>
</div><div class="cl-preview-section"><pre class=" language-kotlin"><code class="prism  language-kotlin">  <span class="token comment">/**
   * Returns true if the code is in [200..300), which means the request was successfully received,
   * understood, and accepted.
   */</span>
  <span class="token keyword">val</span> isSuccessful<span class="token operator">:</span> Boolean
    <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> code <span class="token keyword">in</span> <span class="token number">200</span><span class="token operator">..</span><span class="token number">299</span>
</code></pre>
</div><div class="cl-preview-section"><p>发现和自己设想的不同，响应码的范围是 [200…300)。</p>
</div><div class="cl-preview-section"><p>通过这个简单的例子，我们发现自己对 HTTP 响应码的理解不够全面。</p>
</div><div class="cl-preview-section"><p>另外通过这个源码我们也了解到了源码注释的重要性，通过源码注释可以清楚明白的理解该函数的意图。</p>
</div><div class="cl-preview-section"><h2 id="从设计模式的角度学源码">4.5 从设计模式的角度学源码</h2>
</div><div class="cl-preview-section"><p>很多优秀的开源项目都会用到各种设计模式，尤其是学习 Spring 源码。</p>
</div><div class="cl-preview-section"><p>因此，强烈建议要了解常见的设计模式。</p>
</div><div class="cl-preview-section"><p>了解常见设计模式的目的、核心场景、优势和劣势等。</p>
</div><div class="cl-preview-section"><p>要理解<strong>设计模式的六大原则</strong>：单一职责原则、开闭原则、依赖倒置原则、接口隔离原则、迪米特法则等。</p>
</div><div class="cl-preview-section"><p>在读源码时注意体会设计模式的六大原则在源码中的体现。</p>
</div><div class="cl-preview-section"><p>如<a href="https://github.com/fengjiachun/Jupiter"> jupiter </a>1.3.1 版本的 <code>org.jupiter.serialization.SerializerFactory</code> 类就体现了工厂模式。该类通过在静态代码块中使用 SPI 机制加载序列化方式并存储到 <code>serializers</code> map 中，获取时从该 map 中直接取，实现了已有对象的重用。<br>
<img src="https://img.mukewang.com/5ece41af00019bf413070633.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p>大家可以通过《设计模式之禅》、《Java 设计模式及实践》、《Head first 设计模式》等来学习设计模式。</p>
</div><div class="cl-preview-section"><p>从设计模式角度阅读源码，可以加深对设计模式应用场景的理解，自己编码时更容易选择适合的设计模式来应对项目中的变化。</p>
</div><div class="cl-preview-section"><h2 id="读源码的粒度问题">4.6 读源码的粒度问题</h2>
</div><div class="cl-preview-section"><p>很多开源项目代码行数非常多，几十万甚至上百万行，想都读完并且都能记下来不太现实。</p>
</div><div class="cl-preview-section"><p>前面也讲到读源码读什么的问题，个人建议大家读核心的原理，关键特性的实现，高抽象层的几个关键步骤。</p>
</div><div class="cl-preview-section"><h1 id="读源码的技巧">5. 读源码的技巧</h1>
</div><div class="cl-preview-section"><h2 id="通过注释学习源码">5.1 通过注释学习源码</h2>
</div><div class="cl-preview-section"><p>我们以 guava  源码 commit id 为 5a8f19bd3556 的提交版的 <code>CacheBuilder</code> 源码为例。</p>
</div><div class="cl-preview-section"><p>如果我们想了解 expireAfterWrite 函数的的用法。</p>
</div><div class="cl-preview-section"><p>可以通过读其注释了解该函数的功能，每个参数的含义，异常发生的原因等。对我们学习源码和实际工作中的使用帮助极大。</p>
</div><div class="cl-preview-section"><pre class=" language-java"><code class="prism  language-java">  <span class="token comment">/**
   * Specifies that each entry should be automatically removed from the cache once a fixed duration
   * has elapsed after the entry's creation, or the most recent replacement of its value.
   * // 省略其他
   *
   * @param duration the length of time after an entry is created that it should be automatically
   *     removed
   * @param unit the unit that {@code duration} is expressed in
   * @return this {@code CacheBuilder} instance (for chaining)
   * @throws IllegalArgumentException if {@code duration} is negative
   * @throws IllegalStateException if the time to live or time to idle was already set
   */</span>
  <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"GoodTime"</span><span class="token punctuation">)</span> <span class="token comment">// should accept a java.time.Duration</span>
  <span class="token keyword">public</span> CacheBuilder<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">&gt;</span> <span class="token function">expireAfterWrite</span><span class="token punctuation">(</span><span class="token keyword">long</span> duration<span class="token punctuation">,</span> TimeUnit unit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">checkState</span><span class="token punctuation">(</span>
        expireAfterWriteNanos <span class="token operator">==</span> UNSET_INT<span class="token punctuation">,</span>
        <span class="token string">"expireAfterWrite was already set to %s ns"</span><span class="token punctuation">,</span>
        expireAfterWriteNanos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">checkArgument</span><span class="token punctuation">(</span>duration <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"duration cannot be negative: %s %s"</span><span class="token punctuation">,</span> duration<span class="token punctuation">,</span> unit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>expireAfterWriteNanos <span class="token operator">=</span> unit<span class="token punctuation">.</span><span class="token function">toNanos</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><h2 id="通过单元测试学源码">5.2 通过单元测试学源码</h2>
</div><div class="cl-preview-section"><p>同样以学习 5.1 的函数为例，可以通过 find usages 找到对应的单元测试。</p>
</div><div class="cl-preview-section"><p>com.google.common.cache.CacheExpirationTest#testExpiration_expireAfterWrite</p>
</div><div class="cl-preview-section"><p>可以执行在源码中断点，然后执行单元测试，了解源码细节。</p>
</div><div class="cl-preview-section"><pre class=" language-java"><code class="prism  language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testExpiration_expireAfterWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  FakeTicker ticker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FakeTicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  CountingRemovalListener<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token operator">&gt;</span> removalListener <span class="token operator">=</span> <span class="token function">countingRemovalListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  WatchedCreatorLoader loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WatchedCreatorLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  LoadingCache<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token operator">&gt;</span> cache <span class="token operator">=</span>
      CacheBuilder<span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">expireAfterWrite</span><span class="token punctuation">(</span>EXPIRING_TIME<span class="token punctuation">,</span> MILLISECONDS<span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">removalListener</span><span class="token punctuation">(</span>removalListener<span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">ticker</span><span class="token punctuation">(</span>ticker<span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>loader<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">checkExpiration</span><span class="token punctuation">(</span>cache<span class="token punctuation">,</span> loader<span class="token punctuation">,</span> ticker<span class="token punctuation">,</span> removalListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><h2 id="从入口开始学源码">5.3 从入口开始学源码</h2>
</div><div class="cl-preview-section"><p>如下面是常见的 springboot 的应用启动主函数：</p>
</div><div class="cl-preview-section"><pre class=" language-java"><code class="prism  language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoApplication</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        SpringApplication<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>DemoApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><p>我们可以从  <code>SpringApplication</code> 的 <code>run</code> 函数一直跟下去。</p>
</div><div class="cl-preview-section"><p>有些朋友可能会说，跟着<strong>跟丢了怎么办？</strong></p>
</div><div class="cl-preview-section"><p>大家可以在源码中打断点，然后通过左下角的调用栈实现源码的跳转，可以通过 “drop frame” 实现<br>
<img src="https://img.mukewang.com/5ece41d10001b4a010910737.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><h2 id="利用插件来学源码">5.4 利用插件来学源码</h2>
</div><div class="cl-preview-section"><h3 id="类图插件">5.4.1 类图插件</h3>
</div><div class="cl-preview-section"><p>可以使用 IDEA 自带的类图了解核心类的源码的关系。</p>
</div><div class="cl-preview-section"><p>如下图为 fastjson 的核心类的类图：<br>
<img src="https://img.mukewang.com/5ece41e500013eff12390664.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><h3 id="时序图插件">5.4.2 时序图插件</h3>
</div><div class="cl-preview-section"><p>可以使用 <a href="https://plugins.jetbrains.com/plugin/10749-stack-trace-to-uml/">Stack trace to UML</a> IDEA 插件绘制错误堆栈的时序图，了解源码的执行流程。</p>
</div><div class="cl-preview-section"><p>推荐大家安装  <a href="https://github.com/Vanco/SequencePlugin">SequenceDiagram</a> IDEA 插件，读源码时可以查看调用的时序图，对理解源码调用关系帮助很大。<br>
<img src="https://img.mukewang.com/5ece420e00014fb216000894.jpg" alt="图片描述"></p>
</div><div class="cl-preview-section"><h3 id="codota">5.4.3 codota</h3>
</div><div class="cl-preview-section"><p>强烈推荐大家安装  codota 插件（支持 Eclipse 、IDEA、Android Studio） 通过该插件或对应的 <a href="https://www.codota.com/code">Java 代码搜索网站</a>。</p>
</div><div class="cl-preview-section"><p>如下图所示，我们安装好 codota 插件后，想了解 org.springframework.beans.factory.support.BeanDefinitionRegistry <code>的</code> registerBeanDefinition` 函数用法。</p>
</div><div class="cl-preview-section"><p>直接在该函数上右键然后选择 “Get relevant examples” ，即可查看其他知名开源项目中的相关用法。<br>
<img src="https://img.mukewang.com/5ece42230001a58512840897.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p>这对我们了解该源码的功能和用法有极大的帮助，我们实际开发中也可以多用 codota 来快速学习如何使用一个函数。</p>
</div><div class="cl-preview-section"><h2 id="通过提交记录学源码">5.5 通过提交记录学源码</h2>
</div><div class="cl-preview-section"><p>比如我们想研究某段源码的变动，可以拉取源代码，查看 git 提交记录。</p>
</div><div class="cl-preview-section"><p>比如我们想研究某个感兴趣类的演进，直接选取该类，查看提交记录即可。</p>
</div><div class="cl-preview-section"><p>下图为 commons-lang 项目的，StringUtils 工具类的一个变更记录：<br>
<img src="https://img.mukewang.com/5ece4236000154f813770215.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p>通过变更记录我们可以学习到早期版本有哪些问题，如何进行优化。</p>
</div><div class="cl-preview-section"><p>当然，还有很多其他读源码的技巧，比如通过反编译、反编译那学源码（在后续章节会讲到），这里就不一一列举了。</p>
</div><div class="cl-preview-section"><h1 id="总结">6. 总结</h1>
</div><div class="cl-preview-section"><p>本文重点讲解了 Java 源码学习的重要性，讲解学习源码的常见误区，然后通过讲解阅读源码的思想和阅读源码的技巧来阐述如何阅读源码更有效。通过本节的学习为后面深入解析《Effective Java》知识点做准备，同时希望本节介绍的方法和经验能够对大家在未来的学习和工作的进阶中有帮助。</p>
</div><div class="cl-preview-section"><p>下一节将讲述 Java 反编译，讲述学习反编译的好处，学习反编译对我们后面学习和研究的意义。</p>
</div><div class="cl-preview-section"><h1 id="思考与练习">7. 思考与练习</h1>
</div><div class="cl-preview-section"><p>1、 使用 IDEA 自带的类图插件，绘制 Java Collection 类图。</p>
</div><div class="cl-preview-section"><p>2 安装体验 SequenceDiagram IDEA 插件。</p>
</div><div class="cl-preview-section"><p>3、 Stack trace to UML IDEA 插件只支持根据错误堆栈绘制时序图，那么如何在调试时用上该插件绘制出当前调试的时序图呢？</p>
</div><div class="cl-preview-section"><p>欢迎在留言区进行评论和探讨。</p>
</div>
			
		</div>
	
	
	<div class="finish-learn">
		<p class="copyright">©版权归慕课网所有，未经许可不得转载</p>
		
		
		
		<div class="ad_pic">
			<img src="https://img4.mukewang.com/5ece2691000109e706700192.jpg">
		</div>
		
		
		
		
	</div>
	<div class="comment-con">
		<h4 class="title">
			精选留言
			
				<a href="javascript: void(0);" class="add-comment js-comment-click"><i class="imwap-xieliuyan"></i><span>写留言</span></a>
			
		</h4>
		
			<ul class="comment-content">
				
				<li class="item">
					<a href="/read/commentdetail/6773">
						<img src="https://img3.mukewang.com/5458633f0001c2a902200220-100-100.jpg" alt="" class="avatar">
						<h4 class="nickname">慕粉3543028</h4>
						<div class="comment-text">明月很用心，加油加油！</div>
						<div>
							
								<div class="reply">讲师回复：多谢支持，欢迎推荐给身边的朋友一起学习</div>
							
						</div>
					</a>
					<p class="bottom">
						<span class="l">2020-09-13</span>
						<a href="/read/commentdetail/6773">
							<span class="icon r"><i class="imwap-comment"></i><em>1</em></span>
						</a>
						<span data-cid="6773" class="icon r js-comment-upvote "><i class="imwap-thumb_up"></i><em>0</em></span>
					</p>
				</li>
				
				<li class="item">
					<a href="/read/commentdetail/6524">
						<img src="https://img4.mukewang.com/545862800001e2d802200220-100-100.jpg" alt="" class="avatar">
						<h4 class="nickname">奋浩</h4>
						<div class="comment-text">IDEA社区版可以装老师说的这些插件吗？</div>
						<div>
							
								<div class="reply">讲师回复：大多数都是通用的，应该问题不大，试一下。</div>
							
						</div>
					</a>
					<p class="bottom">
						<span class="l">2020-08-13</span>
						<a href="/read/commentdetail/6524">
							<span class="icon r"><i class="imwap-comment"></i><em>1</em></span>
						</a>
						<span data-cid="6524" class="icon r js-comment-upvote "><i class="imwap-thumb_up"></i><em>0</em></span>
					</p>
				</li>
				
				<li class="item">
					<a href="/read/commentdetail/6132">
						<img src="https://img1.mukewang.com/5f0d3c86000165cc03160336-100-100.jpg" alt="" class="avatar">
						<h4 class="nickname">暖暖123</h4>
						<div class="comment-text">一时间接收的学习工具太多，需要慢慢消化。作为小白，感觉将来读源码之路将会少走很多弯路。学长写的真好</div>
						<div>
							
								<div class="reply">讲师回复：这些工具方法需要自己实际去实践才能有效果，希望对你有帮助，加油！
另外欢迎你推荐给身边的朋友一起学习。</div>
							
						</div>
					</a>
					<p class="bottom">
						<span class="l">2020-07-14</span>
						<a href="/read/commentdetail/6132">
							<span class="icon r"><i class="imwap-comment"></i><em>1</em></span>
						</a>
						<span data-cid="6132" class="icon r js-comment-upvote "><i class="imwap-thumb_up"></i><em>1</em></span>
					</p>
				</li>
				
				<li class="item">
					<a href="/read/commentdetail/6103">
						<img src="https://img3.mukewang.com/5d542ec90001a13216001600-100-100.jpg" alt="" class="avatar">
						<h4 class="nickname">小滕lo</h4>
						<div class="comment-text">不错不错</div>
						<div>
							
						</div>
					</a>
					<p class="bottom">
						<span class="l">2020-07-11</span>
						<a href="/read/commentdetail/6103">
							<span class="icon r"><i class="imwap-comment"></i><em>0</em></span>
						</a>
						<span data-cid="6103" class="icon r js-comment-upvote "><i class="imwap-thumb_up"></i><em>1</em></span>
					</p>
				</li>
				
				<li class="item">
					<a href="/read/commentdetail/5725">
						<img src="https://img.mukewang.com/5333a1660001394602000200-100-100.jpg" alt="" class="avatar">
						<h4 class="nickname">慕标3246374</h4>
						<div class="comment-text">还停留在对着答案做题的阶段需要突破</div>
						<div>
							
								<div class="reply">讲师回复：嗯，转变学习和思维习惯很重要</div>
							
						</div>
					</a>
					<p class="bottom">
						<span class="l">2020-06-04</span>
						<a href="/read/commentdetail/5725">
							<span class="icon r"><i class="imwap-comment"></i><em>1</em></span>
						</a>
						<span data-cid="5725" class="icon r js-comment-upvote "><i class="imwap-thumb_up"></i><em>1</em></span>
					</p>
				</li>
				
			</ul>
			
		
	</div>
	
	

	
		
	
	
	
		<div class="bottom-con">
			
			
				<div class="inner">
					
						<div class="price-con js-price-con">
							<span class="now">￥68.00</span>
						</div>
							
					
					
					<a class="gobuy js-gobuy" href="//m.imooc.com/account/login?backurl=//m.imooc.com/confirmorder?type=30&typeid=78">
					
						立即购买
					</a>  
				</div>
			
		</div>
	
	<div class="layer-catalog js-layer-catalog hide">
		<div class="layer-title clearfix">
			<div class="l">
				课程目录
			</div>
			
		</div>
		<div class="layer-wrap">
			<div class="js-catalog-container">
			</div>
		</div>
	</div>
	<div class="layer-comment">
		<div class="inner">
			<h5>
				<span class="btn l js-cancel-comment">取消</span>
				评论
				<span class="btn r js-send-comment">发送</span>
			</h5>
			<textarea id="comment-txt" maxlength="20000" placeholder="欢迎在这里发表留言，作者筛选后可公开显示"></textarea>
		</div>
	</div>


            </div>
        </div>
        
            
         
        
        
        
        




<script>
	// 设置字号大小及选中
	(function() {
			var fs = window.localStorage.getItem('font-size') || 'normal';
			var $c = document.querySelector('#middle>.content');
			var $points = document.querySelectorAll('.setting-box .point');
			try{
				// 抢读完了时 该元素不渲染 会有报错
				$c.className = 'content ' + fs;
				for(var i = 0; i < $points.length; i++) {
					if($points[i].className.indexOf(fs) > -1) {
						$points[i].className = $points[i].className + ' current';
					}
				}
			} catch(e) {}
			
	})();
</script>

<script type="text/javascript">
	window.onload = function() {
			zhuge.track('LearnCourse', {
					'Category': '专栏',
					'Name': '02 Java 源码学习指南',
					'CID': '1976',
					'Teacher': '明明如月'
			});
	}
</script>

        
            <script type="text/javascript">
                var shareData = { 
                    title:  "02 Java 源码学习指南",
                    desc: "学习Java很重要，学会怎么学习Java更重要",
                    imgUrl: 'https:https://img2.mukewang.com/5ecf522a00013a1d05400720.jpg',
                    otherImgUrl: 'https://img2.mukewang.com/5ecf522a00013a1d05400720.jpg',
                    text: '我正在参加@慕课网的课程，很不错哦！快来一起学习吧！',
                    // url: 'https://www.imooc.com' + window.location.pathname + window.location.search
                    url: 'https://m.imooc.com/read/78',
                    link: 'https://m.imooc.com/read/78'
                }
            </script>
            
        
        <div style="display:none;">
            <!-- 百度统计 -->
            <script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?c92536284537e1806a07ef3e6873f2b3";
              var s = document.getElementsByTagName("script")[0];
              s.parentNode.insertBefore(hm, s);
            })();
            </script>

            <script>
            (function(){
                var bp = document.createElement('script');
                var curProtocol = window.location.protocol.split(':')[0];
                if (curProtocol === 'https') {
                    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                }
                else {
                    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                }
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(bp, s);
            })();
            </script>
        </div>
        
    <script type="text/javascript" src="https://m.imooc.com/static/wap/static/lib/zhugeio/init_f9752c3.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/common/js/jquery-2.1.0.min_ac9f840.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/common/js/common_84429c0.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/lib/juicer/juicer.min_8643248.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/lib/previewImage/previewImage.min_43b970d.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/common/js/msg_bed8d10.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/js/read/7.2.8/article_30e5762.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/js/course/advertisementReport_6e58a98.js"></script></body>
</html>
