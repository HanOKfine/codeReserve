<!doctype html>
<html lang="zh_CN">

    

    

    
    
    
    <head>
        
        <title>31 运行 Spring Boot 应用的几种方式</title>
        
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="够吃管饱的SpringBoot大餐">
        <meta name="keywords" content="慕课网">
        <meta name="author" content="">
        <meta name = "format-detection" content="telephone=no">
        <meta http-equiv="Cache-Control" content="no-transform " />
        <meta http-equiv="Cache-Control" content="no-siteapp" />
        <link rel="shortcut icon" href="https://m.imooc.com/static/wap/static/favicon.ico" />
        
        
        
        <script type="text/javascript" src="https://m.imooc.com/static/wap/static/common/js/flexible.js"></script>
        
        <script type="text/javascript">
            var userInfo = "";
            
                var isApp = 0;
            
        </script>
         
<!-- 专栏首页列表模板 -->
<script type="text/template" id="index-list-tpl">
<ul class="list-con">
    {@each data.data as item}
        <li>
            <a href="/read/${item.id}" class="item clearfix">
                <div class="img l" style="background-image: url(${item.app_pic1})">
                    {@if item.is_new }
                        <div class="icon new">
                            上新
                        </div>
                    {@else if item.is_marking} 
                        <div class="icon">
                            经典
                        </div>
                    {@/if} 
                </div>
                <div class="text-con l">
                    <div class="title">
                        ${item.title}
                    </div>
                    <div class="desc">
                        ${item.chapter_num}节 · ${item.description}
                    </div>
                     <div class="user-info">
                        ${item.nickname}
                        {@if item.author_title }
                        <span class="dot">
                            ·
                        </span>
                        ${item.author_title}
                        {@/if}
                    </div>
                    <div class="info clearfix">
                    {@if !item.isBuy } 
                        <!-- 未购买才显示 -->
                        <div class="price-con l">
                        {@if item.open_discount == "1" }
                            <span class="now">￥${item.pay_price}</span>
                            <span class="ori">￥${item.price}</span>
                            <p class="sale">${item.discount_name}</p>
                        {@else}
                            <span class="now">￥${item.price}</span>
                        {@/if}
                        </div>
                    {@/if}
                        <div class="taste-con r">
                            <span>${item.numbers}人订阅</span>
                            {@if !item.isBuy }
                                <span class="gotaste">试读</span>
                            {@else}
                                <span class="gotaste">学习</span>
                            {@/if}
                        </div>
                    </div>
                </div>
            </a>
        </li>
    {@/each}
</ul>
</script>



<!-- 专栏目录 买后目录页、 -->
<script type="text/template" id="detail-catalog-tpl">
<ul class="catalog-list">
{@each data.list as item}
    <li class="zhang">
        {@if data.structure_mode == "1" }
            <!--章节模式-->
            <div class="zhang-title">
                ${item.title}（${item.count}节）
            </div>
            <div class="zhang-sub-title">
                ${item.short_introduce}
            </div>
        {@/if}  
        <ul class="zhang-detail">
            {@each item.list as it,i}
                <li class="jie">
                    {@if data.isLogin }
                        <!-- 购买了  -->
                        {@if data.isBuy }
                        <a href="javascript:;" data-link="/read/${data.column_id}/article/${it.id}" class="js-go-read">
                        {@else}
                        <a href="javascript:;" data-link="/read/${data.column_id}/article/${it.id}" class="js-go-read" >
                        {@/if}
                    {@else}
                        <!-- 未登录  -->
                        {@if data.isApp }
                            <a href="javascript:;" onclick="window.nativeSupport.login();">
                        {@else}
                            <a href="//m.imooc.com/account/login?backurl=/read/${data.column_id}">
                        {@/if}
                    {@/if}
                        <div class="jie-con {@if data.last_chapter == it.id }recent{@/if}">
                            
                            <div class="text-con">
                                <div class="jie-title">
                                    ${it.title}
                                </div>
                                <div class="jie-status">
                                    {@if it.is_open == "0" }
                                        <span class="update-time" >${it.open_time_fmt}</span>
                                    {@/if}
                                    {@if it.view_num > 100 }
                                    <div class="learn-num">
                                        <i class="imwap-set-sns"></i>
                                        <span>${it.view_num}</span>
                                    </div>
                                    {@/if}
                                    {@if it.in_24hours == "1" }
                                        <span class="update-recent">最近更新</span>
                                    {@/if}
                                </div>
                            </div>
                        </div>
                        {@if it.is_learned }
                            <div class="jie-right haslearn is_learned js-learn" data-type="1">
                                已学
                            </div>
                        {@else}
                            <!-- 购买了  -->
                            {@if data.isBuy }
                                <div class="jie-right learn js-learn" data-type="1">
                                    学习
                                </div>
                            {@else}
                                {@if it.is_pay == "0" }
                                <!--免费小节 不占用试读次数  -->
                                    <div class="jie-right learn js-learn" data-type="1">
                                        免费
                                    </div>
                                {@else}
                                    <div class="jie-right learn js-learn" data-type="0">
                                        学习
                                    </div>
                                {@/if}
                            {@/if}
                            
                            
                        {@/if}
                    </a>
                </li>
            {@/each}
        </ul>
    </li>
{@/each}
</ul>
</script> 

<!-- 阅读页 阅读页   专栏目录  -->
<script type="text/template" id="catalog-tpl">
<div>
    <h2 class="article-title">${data.a_name}</h2>
    <ul class="catalog">
    {@each data.list as item}
        <li class="zhang">
            {@if data.structure_mode == "1" }
                <!--章节模式-->
                <div class="zhang-title">
                    ${item.title}
                    <!-- <div class="num">共${item.count}节</div> -->
                </div>
            {@/if}  
            <ul class="zhang-detail">
                {@each item.list as it,i}
                    <li class="jie">
                        <!--买了且开放的-->
                        <a href="/read/${data.column_id}/article/${it.id}">
                            <div class="jie-title clearfix full">
                                <p>
                                    {@if data.last_chapter == it.id }
                                        <span class="recent">最近阅读</span>
                                    {@/if}
                                    ${it.title}
                                </p>
                            </div>
                        </a>
                    </li>
                {@/each}
            </ul>
        </li>
    {@/each}
    </ul>
</div>
</script>





<script type="text/javascript">
	var isApp = "";
	var clientVersion = "0";
	var count_num = "2";
	var chapter_id = "1827";
	var chapter_title = "31 运行 Spring Boot 应用的几种方式";
	var aid = "75";
	var a_name = "SpringBoot 趣味私房课";
	var a_price = "58.00";
	var a_pic = "https://img.mukewang.com/5e9cfd1f0001ece605400720.jpg";
	var userId = 0;

	var column_id = '75';
	var isLogin = 0;
	

</script>
<!-- 引入字体 -->
<script type="text/javascript" src="//cdn.webfont.youziku.com/wwwroot/js/wf/youziku.api.min.js"></script>
<script type="text/javascript">
$youziku.load(".top-con .title, .cl-preview-section h1,.cl-preview-section h2,.cl-preview-section h3,.cl-preview-section h4,.cl-preview-section h5,.cl-preview-section h6", "37af461390fa4d138f5c3d277f7286dc", "SourceHanSerifSC-Heavy"); // 思源宋体heavy
$youziku.load(".lead-motto, .cl-preview-section blockquote", "d9a0d855583142c3b2cc3bf1646a8473", "SourceHanSerifSC-Regular"); // 思源宋体regular
$youziku.load("#article_content, .cl-preview-section pre, .cl-preview-section code, #code-copy", "3d84aabcf9e44b6f8c6fa91c61fa926e", "HYQiHei-55S"); // 汉仪旗黑55s
$youziku.load(".cl-preview-section strong", "fd94fff3a17546a28913a79613bddcec", "HYQiHei-77S"); // 汉仪旗黑70s

$youziku.draw();
</script>

<style type="text/css">
  header{
    display: none!important;
  }
  
  #wrapper{
  	padding-top:0px !important;
  }
  
</style>



    <link rel="stylesheet" href="https://m.imooc.com/static/wap/static/common/css/common_d42b1ef.css" /><link rel="stylesheet" href="https://m.imooc.com/static/wap/static/css/read/7.2.8/article_2d28313.css" /></head>
    <body >
        
          
        

        
          
        

        
          







<header class="directory2">
	<div class="header clearfix">
		
			
				<div class="page-title clearfix">
					<a href="//m.imooc.com" class="imwap-icon-imooc"></a>
					<div class="page-title-name js-page-name">
						<span>专栏</span>
						<i class="imwap-arrow_d"></i>
					</div>
				</div>
			

			
			<div class="drawer-box js-drawer-more">
				<i class="imwap-more_vert"></i>
				<div class="drawer-content js-drawer-content">
					<p class="line-row"></p>
					<a class="drawer-item" href="//m.imooc.com"><i class="imwap-center"></i>回到首页</a>
					<a class="drawer-item" href="//www.imooc.com/m/web/user/usercenter.html"><i class="imwap-peaple"></i>个人中心</a>
					<a class="drawer-item" href="//m.imooc.com/feedback"><i class="imwap-comment"></i>反馈问题</a>
					
					<a class="drawer-item" href="//m.imooc.com/account/login"><i class="imwap-out"></i>注册登录</a>
					
				</div>
			</div>
			

			
				<a id="js-appload" href="Javascript:;" class="app-load"><span>下载APP</span></a>
			

		
	</div>
	
	<div class="page-tab-wrap">
		<div class="page-tab-list">
			<a href="//m.imooc.com" class="page-tab-item">首页</a>
			<a href="//m.imooc.com/course/list" class="page-tab-item">课程</a>
			<a href="//coding.m.imooc.com" class="page-tab-item">实战</a>
			<a href="//class.m.imooc.com" class="page-tab-item">金职位</a>
			<a href="//m.imooc.com/article" class="page-tab-item">手记</a>
			<a href="//m.imooc.com/read" class="page-tab-item active">专栏</a>
			<a href="//m.imooc.com/wenda" class="page-tab-item">猿问</a>
			<a href="//m.imooc.com/wiki" class="page-tab-item">慕课教程</a>
			
		</div>
	</div>
	
</header>


        

        <div id="wrapper">
            <div id="middle" class="container ">

                

                
	
		
	
	<div class="top-con">
		<p class="update-time"><span>2020-06-01&nbsp;&nbsp;&nbsp;更新</span></p>
		<div class="title">
			31 运行 Spring Boot 应用的几种方式
		</div>
	</div>
	
		<div class="article-img" style="background-image: url('https://img3.mukewang.com/5ebe62cd0001e0b122501500.jpg')"></div>
	
	
		<a href="/read/75">
			<div class="course-entry">
				<img src="https://img1.mukewang.com/5e776f3c000149fd10801080-40-40.jpg" alt="刘水镜">
				<h3>SpringBoot 趣味私房课</h3>
				<p>刘水镜 · 知名 A.I. 公司 Java 工程师</p>
				<i class="imwap-arrow_r"></i>
			</div>
		</a>
	
	
		<div class="lead-motto">
			<div class="content">青年是学习智慧的时期，中年是付诸实践的时期。 <p class="author">—— 卢梭</p></div>
		</div>
	
	
		<div class="content" id="article_content">
			
			<div class="cl-preview-section"><h1 id="前言">1. 前言</h1>
</div><div class="cl-preview-section"><p>恭喜你！掌握了前面章节讲解的知识，你已经具备了独立开发一个中小型系统的能力。开不开心？先别急，我们还差最后一步，才能让我们开发的应用投入使用 —— 那就是部署。</p>
</div><div class="cl-preview-section"><p>在 Spring Boot 出现之前，部署通常是将打好的 War 包放到 Tomcat（或其他 Web 容器）的 WebApps 目录下，然后启动 Tomcat。你可能还记得在《万事开头难？Spring Boot 表示不服！》中，我们选择的打包类型是 Jar 而不是 War。那 Jar 格式的工程如何启动呢？接下来我们来揭开谜底，并对比 War 和 Jar 的异同点。</p>
</div><div class="cl-preview-section"><h1 id="war-与-jar">2. War 与 Jar</h1>
</div><div class="cl-preview-section"><p>Spring Boot 推荐我们使用 Jar 的方式打包和运行我们的工程（也是默认方式）。通过这段时间对于 Spring Boot 的了解，我们已经发现了一个规律 —— 采用 Spring Boot 推荐的方式（约定优于配置）通常都非常简单（基本上不需要额外的工作）。当然 Spring Boot 也会给我们自定义的自由，需要做一点额外的配置而已。</p>
</div><div class="cl-preview-section"><h2 id="jar">2.1 Jar</h2>
</div><div class="cl-preview-section"><p>采用 Jar 的方式打包应用，我们不需要做任何额外的事情，按部就班的通过 Maven 打包就行了。执行完打包命令，在 target 目录就会生成一个 Jar 文件，如：helloworld-0.0.1-SNAPSHOT.jar。然后使用 <code>java -jar</code> 命令来启动就可以了。</p>
</div><div class="cl-preview-section"><p>打开系统命令行工具，将路径切换到 Jar 文件所在的目录，然后执行：</p>
</div><div class="cl-preview-section"><pre class=" language-shell"><code class="prism  language-shell">java -jar helloworld-0.0.1-SNAPSHOT.jar
</code></pre>
</div><div class="cl-preview-section"><p>接下来就可以看到熟悉的启动日志了，等应用启动完成以后，就可以访问我们写的接口了，很简单。</p>
</div><div class="cl-preview-section"><h2 id="war">2.2 War</h2>
</div><div class="cl-preview-section"><p>Spring Boot 让人喜爱的地方除了它为我们做了 N 多自动配置，还有另外一个可爱之处，就是能够非常方便的使用自定义配置。完美的兼顾了方便与灵活，Spring Boot 具有这样既贴心又开放的 “性格”，不由得你不喜欢。</p>
</div><div class="cl-preview-section"><p>下面我们就通过自定义配置，将 Spring Boot 工程以传统的 War 方式进行打包。我们只需要修改两个文件即可 ——SpringbootApplication（项目主类）和 pom 文件。</p>
</div><div class="cl-preview-section"><h3 id="修改主类">修改主类</h3>
</div><div class="cl-preview-section"><p>修��项目主类：</p>
</div><div class="cl-preview-section"><pre class=" language-java"><code class="prism  language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringbootApplication</span> <span class="token keyword">extends</span> <span class="token class-name">SpringBootServletInitializer</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        SpringApplication<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>SpringbootApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> SpringApplicationBuilder <span class="token function">configure</span><span class="token punctuation">(</span>SpringApplicationBuilder builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">sources</span><span class="token punctuation">(</span>SpringbootApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><p>主类需要继承 SpringBootServletInitializer，然后重写 configure () 方法，这样主类就修改完了。</p>
</div><div class="cl-preview-section"><h3 id="修改-pom-文件">修改 pom 文件</h3>
</div><div class="cl-preview-section"><p>pom 文件中需要修改三个地方：</p>
</div><div class="cl-preview-section"><ol>
<li>修改打包方式</li>
<li>修改依赖项</li>
<li>设置 War 文件名</li>
</ol>
</div><div class="cl-preview-section"><p>具体代码如下：</p>
</div><div class="cl-preview-section"><pre class=" language-xml"><code class="prism  language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    ......
    <span class="token comment">&lt;!-- 修改成 war --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">&gt;</span></span>war<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 移除内置 Tomcat --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-tomcat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- 添加 Tomcat 依赖，用于在 IDE 中运行项目 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-tomcat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        ......
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 设置 war 文件名 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>finalName</span><span class="token punctuation">&gt;</span></span>springboot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>finalName</span><span class="token punctuation">&gt;</span></span>
    	......
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre>
</div><div class="cl-preview-section"><p>接下来使用 Maven 进行打包，打包完成后将 War 文件复制到 Tomcat 的 Webapps 目录下，然后运行 startup 脚本（Tomcat 的启动脚本在 bin 目录下）搞定。</p>
</div><div class="cl-preview-section"><h1 id="devtools">3. DevTools</h1>
</div><div class="cl-preview-section"><p>DevTools 是 Spring Boot 1.3 版本引入的一组开发者工具，目的是为了提高开发效率。其中一个很重要的功能就是，当代码修改后会自动帮我们重启应用。就这个？比我自己重启也强不到哪去呀！如果只是将原来的手动变成了自动，那真的就没啥好说的了。</p>
</div><div class="cl-preview-section"><p><strong>自动重启优势所在</strong></p>
</div><div class="cl-preview-section"><p>为了提升重启的速度，Spring Boot 将资源分成了两类：一类是不变对象（例如项目依赖的 Jar 包）；另一类是可变对象（也就是我们应用中的类或者资源文件）。然后用基础类加载器来加载不变对象，用重启类加载器来加载可变对象。</p>
</div><div class="cl-preview-section"><p>那么重启的时候就可以只加载可变对象了。这样一来，启动速度势必会比加载所有资源的方式更快。理论上，项目依赖的第三方资源越多（项目越大），这种机制的优势也就越明显。</p>
</div><div class="cl-preview-section"><h2 id="添加依赖">3.1 添加依赖</h2>
</div><div class="cl-preview-section"><p>引入 DevTools 依赖：</p>
</div><div class="cl-preview-section"><pre class=" language-xml"><code class="prism  language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
</div><div class="cl-preview-section"><h2 id="设置-ide">3.2 设置 IDE</h2>
</div><div class="cl-preview-section"><p>想要使用 Spring Boot 的自动重启功能，需要对 IDE 进行一些设置。我们以 IDEA 为例，需要开启自动构建和自动编译。</p>
</div><div class="cl-preview-section"><h3 id="开启自动构建">开启自动构建</h3>
</div><div class="cl-preview-section"><p>file -&gt; Settings（Mac：IntelliJ IDEA -&gt; Preferences） -&gt; Compiler -&gt; Build Project automatically</p>
</div><div class="cl-preview-section"><p>快捷键（打开设置对话框）：</p>
</div><div class="cl-preview-section"><ul>
<li>Win：Ctrl + Alt + S</li>
<li>Mac：Command + ,</li>
</ul>
</div><div class="cl-preview-section"><p><img src="https://img.mukewang.com/5ed0e3b50001570809820722.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p>Build Project automatically 选项后面有一行小字 ——only works while not running/debugging，勾选了自动构建以后，告诉我只能在非运行（调试）的情况下起作用。IDEA 你是在逗我吗？我们要的就是运行时起作用呀！所以，我们还得再做一个设置。</p>
</div><div class="cl-preview-section"><h3 id="开启自动编译">开启自动编译</h3>
</div><div class="cl-preview-section"><p>Help -&gt; Find Action -&gt; Registry…</p>
</div><div class="cl-preview-section"><p>快捷键：</p>
</div><div class="cl-preview-section"><ul>
<li>Win：Ctrl + Alt + Shift + /</li>
<li>Mac：Command + Option + Shift + /</li>
</ul>
</div><div class="cl-preview-section"><p><img src="https://img.mukewang.com/5ed0e3a600015fc208560424.png" alt="图片描述"><br>
勾选 compiler.autoMake.allow.when.app.running</p>
</div><div class="cl-preview-section"><p><img src="https://img.mukewang.com/5ed0e3950001f86d08670683.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p>可以看到这一项是允许应用在运行期进行自动编译的。</p>
</div><div class="cl-preview-section"><p>经过以上步骤后，在修改完类或者 application.yml 文件，应用就可以自动重启了。</p>
</div><div class="cl-preview-section"><h2 id="自定义规则">3.3 自定义规则</h2>
</div><div class="cl-preview-section"><p>如果你想要定制自动重启的策略，可以通过以下配置项来实现：</p>
</div><div class="cl-preview-section"><pre class=" language-properties"><code class="prism  language-properties"><span class="token comment"># 是否启用自动重启，默认值 true</span>
spring.devtools.restart.enabled

<span class="token comment"># 不在监控范围的目录，默认值去 DevToolsProperties 类中查看</span>
spring.devtools.restart.exclude

<span class="token comment"># 用来设置不需要监控的路径（会与 spring.devtools.restart.exclude 叠加）</span>
spring.devtools.restart.additional-exclude

<span class="token comment"># 用来设置 classpath 以外的监控路径</span>
spring.devtools.restart.additional-paths

<span class="token comment"># 监控 classpath 下文件修改的时间间隔，单位毫秒，默认值 1000</span>
spring.devtools.restart.poll-interval

<span class="token comment"># classpath 下文件无更新的等待时间（超过这个时间没有任何更新就开始进行重启），单位毫秒，默认值 400</span>
spring.devtools.restart.quiet-period

<span class="token comment"># 设置一个用于触发重启的文件，如果不设置，那么 classpath 只要有更改就可以触发重启</span>
spring.devtools.restart.trigger-file
</code></pre>
</div><div class="cl-preview-section"><h1 id="类加载机制">4. 类加载机制</h1>
</div><div class="cl-preview-section"><p>我们都知道，Java 程序需要被 JVM 将编译后的字节码加载到内存，之后才能够运行和使用。JVM 将字节码加载进内存再到形成 JVM 可用的 Java 类型，这一过程就是 Java 的类加载。DevTools 的自动重启正是借助了这种灵活的加载机制才得以实现。</p>
</div><div class="cl-preview-section"><h2 id="加载过程">4.1 加载过程</h2>
</div><div class="cl-preview-section"><p>类加载的过程中，JVM 做了很多工作，这些工作可以分为五个阶段：</p>
</div><div class="cl-preview-section"><p><img src="https://img.mukewang.com/5ed0e37f00012f2604040523.png" alt="图片描述"><br>
如上图所示，整个类加载的过程包含加载、验证、准备、解析、初始化。下面我们分别看看这五个阶段都做了什么。</p>
</div><div class="cl-preview-section"><h3 id="加载">加载</h3>
</div><div class="cl-preview-section"><p>加载是「类加载」的第一个阶段（注意，不要混淆 <code>加载</code> 和 <code>类加载</code>  这两个概念）。在这一阶段，JVM 做了三件事：</p>
</div><div class="cl-preview-section"><ol>
<li>通过类的全限定名（如：java.lang.String）获取类的二进制字节流</li>
<li>将类的字节流转化成方法区（JVM 内存模型中的一个分区）的运行时数据结构</li>
<li>在内存中生成一个对应的 java.lang.Class 对象（就是 foo.getClass () 方法获得的那个类类型对象）</li>
</ol>
</div><div class="cl-preview-section"><blockquote>
<p>二进制字节流不仅可以来自文件系统（class 文件），还可以来自网络或者运行时动态生成。</p>
</blockquote>
</div><div class="cl-preview-section"><h3 id="验证">验证</h3>
</div><div class="cl-preview-section"><p>验证阶段理解起来比较简单，就是验证所加载的内容是否符合 Java 类的规范。比如：</p>
</div><div class="cl-preview-section"><ul>
<li>是否以 <code>CAFEBABE</code> 开头</li>
<li>版本号是否在当前虚拟机的处理范围</li>
<li>常量池符合规范</li>
<li>是否有父类以及父类是否允许被继承</li>
<li>语法验证</li>
<li>…</li>
</ul>
</div><div class="cl-preview-section"><p>目的就是为了保证 JVM 的安全，不能什么东西都直接往 JVM 内存里放。就好比我们坐火车、飞机之前都要安检是一个道理。</p>
</div><div class="cl-preview-section"><h3 id="准备">准备</h3>
</div><div class="cl-preview-section"><p>准备阶段做的事情比较简单，就是为类变量分配内存，并为类变量设置初始值。这里有两个需要注意的地方，一是，类变量指的是 static 修饰的静态变量；二是，设置初始值指的是如有代码：public static int num = 100，在准备阶段会将 num 的值设置为 0，而不是 100（将 num 设置为 100 是初始化阶段要做的事情）。</p>
</div><div class="cl-preview-section"><blockquote>
<p>但如果是 public static <strong>final</strong> int num = 100，那么 num 在准备阶段会被设置成 100</p>
</blockquote>
</div><div class="cl-preview-section"><h3 id="解析">解析</h3>
</div><div class="cl-preview-section"><p>在解析阶段，JVM 会将常量池中的符号引用替换成直接引用。Java 虚拟机规范中并没有严格规定解析阶段的执行时机，只是要求在在执行 16 个特定的指令之前执行。</p>
</div><div class="cl-preview-section"><blockquote>
<p>这 16 个特定的指令是：anewarray、checkcast、getfield、getstatic、instanceof、invokedynamic、invokeinterface、invokespecial、invokestatic、invokevirtual、ldc、lde_w、multianewarray、new、putfield、putstatic</p>
</blockquote>
</div><div class="cl-preview-section"><p>解析主要针对：类、接口、字段、类中的方法、接口中的方法、方法类型、方法句柄和调用点限定符，这 7 类符号引用进行。最后，要说明一点，就是这一段不需要懂，了解一下就行，哈哈哈！</p>
</div><div class="cl-preview-section"><h3 id="初始化">初始化</h3>
</div><div class="cl-preview-section"><p>初始化是类加载的最后一步。在这一阶段 JVM 会为静态变量赋值、执行静态代码块。在讲准备阶段时，示例中的 num 将被赋值为 100。</p>
</div><div class="cl-preview-section"><p>这里有个知识点需要掌握：只有在父类初始化完成以后，才会初始化子类。也就是说，在为父类初始化完静态资源以后，才会处理子类的静态资源。</p>
</div><div class="cl-preview-section"><pre class=" language-java"><code class="prism  language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Father</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        a<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token keyword">extends</span> <span class="token class-name">Father</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><p>上面代码输出 b 的值是 2，而不是 1。这一点经常会在笔试题中遇到。</p>
</div><div class="cl-preview-section"><h1 id="总结">5. 总结</h1>
</div><div class="cl-preview-section"><p>OK，在这一节，我们学习了 Spring Boot 的两种打包方式（Jar 和 War）；还学习了使用 DevTools 设置应用自动重启；最后又简要分析了类的加载机制和每个阶段分别作了什么。又是一次理论与实践的结合。</p>
</div><div class="cl-preview-section"><p>关于类加载这部分内容，对于新手来说理解起来会有点小困难。不用担心，这是正常的，你也不需要一下就弄得特别明白，先了解一下整体，随着不断的积累与实战，你的理解会越来越透彻，这就是学习的一个过程。这一节的内容就到这里，我们下一节不见不散。</p>
</div>
			
		</div>
	
	
	<div class="finish-learn">
		<p class="copyright">©版权归慕课网所有，未经许可不得转载</p>
		
		
		
		<div class="ad_pic">
			<img src="https://img.mukewang.com/5e9a7d3900011d7f06700192.jpg">
		</div>
		
		
		
		
	</div>
	<div class="comment-con">
		<h4 class="title">
			精选留言
			
				<a href="javascript: void(0);" class="add-comment js-comment-click"><i class="imwap-xieliuyan"></i><span>写留言</span></a>
			
		</h4>
		
			<ul class="comment-content">
				
				<li class="item">
					<a href="/read/commentdetail/6137">
						<img src="https://img2.mukewang.com/545865e60001de0902200220-100-100.jpg" alt="" class="avatar">
						<h4 class="nickname">慕UI5387184</h4>
						<div class="comment-text">JRebel它不香吗？</div>
						<div>
							
								<div class="reply">讲师回复：如果免费的话，就比较香了。</div>
							
						</div>
					</a>
					<p class="bottom">
						<span class="l">2020-07-14</span>
						<a href="/read/commentdetail/6137">
							<span class="icon r"><i class="imwap-comment"></i><em>1</em></span>
						</a>
						<span data-cid="6137" class="icon r js-comment-upvote "><i class="imwap-thumb_up"></i><em>0</em></span>
					</p>
				</li>
				
				<li class="item">
					<a href="/read/commentdetail/5937">
						<img src="https://img4.mukewang.com/images/unknow-160.png" alt="" class="avatar">
						<h4 class="nickname">慕慕童鞋</h4>
						<div class="comment-text">DevTools 的功能都很实用。</div>
						<div>
							
								<div class="reply">讲师回复：是的，方便开发人员。</div>
							
						</div>
					</a>
					<p class="bottom">
						<span class="l">2020-06-25</span>
						<a href="/read/commentdetail/5937">
							<span class="icon r"><i class="imwap-comment"></i><em>1</em></span>
						</a>
						<span data-cid="5937" class="icon r js-comment-upvote "><i class="imwap-thumb_up"></i><em>0</em></span>
					</p>
				</li>
				
			</ul>
			
		
	</div>
	
	

	
		
	
	
	
		<div class="bottom-con">
			
			
				<div class="inner">
					
						<div class="price-con js-price-con">
							<span class="now">￥58.00</span>
						</div>
							
					
					
					<a class="gobuy js-gobuy" href="//m.imooc.com/account/login?backurl=//m.imooc.com/confirmorder?type=30&typeid=75">
					
						立即购买
					</a>  
				</div>
			
		</div>
	
	<div class="layer-catalog js-layer-catalog hide">
		<div class="layer-title clearfix">
			<div class="l">
				课程目录
			</div>
			
		</div>
		<div class="layer-wrap">
			<div class="js-catalog-container">
			</div>
		</div>
	</div>
	<div class="layer-comment">
		<div class="inner">
			<h5>
				<span class="btn l js-cancel-comment">取消</span>
				评论
				<span class="btn r js-send-comment">发送</span>
			</h5>
			<textarea id="comment-txt" maxlength="20000" placeholder="欢迎在这里发表留言，作者筛选后可公开显示"></textarea>
		</div>
	</div>


            </div>
        </div>
        
            
         
        
        
        
        




<script>
	// 设置字号大小及选中
	(function() {
			var fs = window.localStorage.getItem('font-size') || 'normal';
			var $c = document.querySelector('#middle>.content');
			var $points = document.querySelectorAll('.setting-box .point');
			try{
				// 抢读完了时 该元素不渲染 会有报错
				$c.className = 'content ' + fs;
				for(var i = 0; i < $points.length; i++) {
					if($points[i].className.indexOf(fs) > -1) {
						$points[i].className = $points[i].className + ' current';
					}
				}
			} catch(e) {}
			
	})();
</script>

<script type="text/javascript">
	window.onload = function() {
			zhuge.track('LearnCourse', {
					'Category': '专栏',
					'Name': '31 运行 Spring Boot 应用的几种方式',
					'CID': '1827',
					'Teacher': '刘水镜'
			});
	}
</script>

        
            <script type="text/javascript">
                var shareData = { 
                    title:  "31 运行 Spring Boot 应用的几种方式",
                    desc: "够吃管饱的SpringBoot大餐",
                    imgUrl: 'https:https://img.mukewang.com/5e9cfd1f0001ece605400720.jpg',
                    otherImgUrl: 'https://img.mukewang.com/5e9cfd1f0001ece605400720.jpg',
                    text: '我正在参加@慕课网的课程，很不错哦！快来一起学习吧！',
                    // url: 'https://www.imooc.com' + window.location.pathname + window.location.search
                    url: 'https://m.imooc.com/read/75',
                    link: 'https://m.imooc.com/read/75'
                }
            </script>
            
        
        <div style="display:none;">
            <!-- 百度统计 -->
            <script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?c92536284537e1806a07ef3e6873f2b3";
              var s = document.getElementsByTagName("script")[0];
              s.parentNode.insertBefore(hm, s);
            })();
            </script>

            <script>
            (function(){
                var bp = document.createElement('script');
                var curProtocol = window.location.protocol.split(':')[0];
                if (curProtocol === 'https') {
                    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                }
                else {
                    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                }
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(bp, s);
            })();
            </script>
        </div>
        
    <script type="text/javascript" src="https://m.imooc.com/static/wap/static/lib/zhugeio/init_f9752c3.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/common/js/jquery-2.1.0.min_ac9f840.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/common/js/common_84429c0.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/lib/juicer/juicer.min_8643248.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/lib/previewImage/previewImage.min_43b970d.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/common/js/msg_bed8d10.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/js/read/7.2.8/article_30e5762.js"></script><script type="text/javascript" src="https://m.imooc.com/static/wap/static/js/course/advertisementReport_6e58a98.js"></script></body>
</html>
